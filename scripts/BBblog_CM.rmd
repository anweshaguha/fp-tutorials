---
title: "**Building Blocks of Functional Programming**"
author: "by Cassie Malcom"
date: "5/6/2022"
output: 
  html_document:
    css: style.css
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(pacman)

pacman::p_load(purrr, tidyverse, repurrrsive, r2symbols, emoji)
```

![](../Lego/legos.jpg)

Hello, and welcome - I assume you are here because you want to learn more about 
data science and in particular functional programming. This blog is designed to 
help you proceed on your data science path by providing an introduction to the 
basic building blocks of functional programming. We'll be working with a freely available data set on Legos&copy;, which you can find here https://www.kaggle.com/datasets/rtatman/lego-database?resource=download.

Let's start by loading the following packages: purrr, tidyverse, and 
repurrrsive. Take a moment to use ?package name to find out what each package 
does.

Next we need to set up a directory for the csv files that we will be using.
```{r}
BBdata_dir <- "/Users/cassiemalcom/Desktop/CM2020/22_Spring Term Classes/EDLD 653_DS3/EDLD653_r/Lego"
```

I've already prepped two of the files for our use today by making sure there is an ID column that matches. We can see what the csv files are by listing them and using regexp to exclude any non-csv files.
```{r}
BBcsv <- fs::dir_ls(BBdata_dir, regexp = "\\.csv$")

BBcsv
```

Next we'll use one of the base functions in R, lapply, to return  a list. The 
lapply function is one of the least restrictive in terms of output within the 
apply family of functions. Notice that our two csv files are being combined 
into one vector based on the color_id column.
```{r}
BBlist <- BBcsv %>% 
  lapply(read_csv) %>%
  reduce(full_join, by = "color_id")

head(BBlist)
```

We can confirm that this is a list with the typeof function. Lists can be very 
helpful as they are vectors (but NOT atomic ðŸ¤¯ ones!) that allow each element 
to be of a different type (i.e., integer, double, logical, character).
```{r}
typeof(BBlist)
```

If we want to know the structure of our list we can use the below function to
see our list's elements.
```{r}
str(BBlist)
```

What if we want to look at a particular row and column [row, column] of our 
list?
```{r}
BBlist[5, 2]
```

Let's check and see if we have any missing values in our list.
```{r}
any(is.na(BBlist))
```

Since there are NAs in our list we can determine their position with the 
following code.
```{r}
which(is.na(BBlist))
```

Now let's convert our list into a dataframe. 
```{r}
BBdf <- data.frame(BBlist)

head(BBdf)
```

Most of the time we have to look at individual building blocks before we can 
proceed to solving larger functional programming problems. Let's start by 
determining the the number of unique times each color appears. The n column in 
count_colors dataframe below shows on how many different parts a color appears.
```{r}
count_colors <- count(BBdf, name)

head(count_colors)
```

```{r}
map(6, rnorm)
```

How about determining the unique amount of each variable in our dataframe? To do
this we'll use our first functional, which is the map function of the purrr 
package. A functional is basically a type of function whose input is also a 
function and whose output is a vector.

Note that purrr uses less code by using the ~ symbol to take the place of 
function(x), which is often used with lapply, with .x as the placeholder for the
thing being looped over. In this case each variable is being looped over.
```{r}
map(BBdf, ~length(unique(.x)))
```

Thinking back to our variables, the variable inventory_id was shown as type 
double, which is numeric. This is not very meaningful for this variable as an id
is a kind of label and we shouldn't try to find a mean or other descriptive 
statistic on it. Let's convert this variable to type character using a variation
of the map function.
```{r}
BBl_chr <- BBlist %>%
  map_chr(coefficients, 6)

BBl_chr
```


Going back to our dataframe we can try splitting it in case we want two smaller 
data sets.
```{r}
#still working through this chunk
```

